<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Pricing | SheetOps</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="{{ url_for('static', filename='price.css') }}">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;800&display=swap" rel="stylesheet">
</head>
<body>
<a href="/" class="back-btn">‚Üê Back</a>
<div class="pricing-container">
  <h1 class="pricing-title">Simple Pricing</h1>
  <p class="pricing-subtitle">
    Choose a plan that fits your Smartsheet admin needs.
  </p>

  <div class="pricing-cards">

    <!-- ======================= TRIAL CARD ======================= -->
    <!-- This card is HIDDEN if the user is an expired trial user -->
    {% if not ('user_id' in session and session['user_plan'] == 'trial') %}
    <div class="pricing-card">
      <h3>Trial</h3>
      <p class="price">$0</p>
      <ul>
        <li>Groups & Users export</li>
        <li>CSV format</li>
        <li>Manual runs</li>
      </ul>
      <form method="POST" action="/select-plan">
        <input type="hidden" name="plan" value="trial">
        <!-- FIX: Removed the <a> tag around the button -->
        <button type="submit" class="btn-outline">Register For Free Trial</button>
      </form>
    </div>
    {% endif %}

    <!-- ======================= PRO CARD ======================= -->
    <div class="pricing-card featured">
      <h3>Pro</h3>
      <p class="price">$15</p>
      <ul>
        <li>All admin endpoints</li>
        <li>CSV + JSON</li>
        <li>Pagination support</li>
      </ul>
      <button class="btn-primary">Contact Us</button>
      <br><br>
      
      <!-- ** DYNAMIC BUTTON LOGIC ** -->
      {% if 'user_id' in session and session['user_plan'] == 'trial' %}
          <!-- User is an expired trial, show UPGRADE button -->
          <form method="POST" action="/upgrade-plan">
              <input type="hidden" name="plan" value="pro">
              <button type="submit" class="btn-outline">Upgrade to Pro</button>
          </form>
      {% else %}
          <!-- New visitor, show REGISTER button -->
          <form method="POST" action="/select-plan">
              <input type="hidden" name="plan" value="pro">
              <button type="submit" class="btn-outline">Register</button>
          </form>
      {% endif %}
    </div>

    <!-- ======================= ENTERPRISE CARD ======================= -->
    <div class="pricing-card">
      <h3>Enterprise</h3>
      <p class="price">$40</p>
      <ul>
        <li>Full automation</li>
        <li>Scheduled exports</li>
        <li>Priority support</li>
      </ul>
      <button class="btn-outline">Contact Us</button>
      <br><br>

      <!-- ** DYNAMIC BUTTON LOGIC ** -->
      {% if 'user_id' in session and session['user_plan'] == 'trial' %}
          <!-- User is an expired trial, show UPGRADE button -->
          <form method="POST" action="/upgrade-plan">
              <input type="hidden" name="plan" value="enterprise">
              <button type="submit" class="btn-outline">Upgrade to Enterprise</button>
          </form>
      {% else %}
          <!-- New visitor, show REGISTER button -->
          <form method="POST" action="/select-plan">
              <input type="hidden" name="plan" value="enterprise">
              <button type="submit" class="btn-outline">Register</button>
          </form>
      {% endif %}
    </div>

  </div>
</div>



</body>
</html>